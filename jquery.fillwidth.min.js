(function(){var $,Li,Row,callQueue,debounce,imagesLoaded,methods,totalPlugins;imagesLoaded=null;(function(){function e(){}function i(e,t){var n=e.length;while(n--){if(e[n].listener===t){return n}}return-1}function s(e){return function(){return this[e].apply(this,arguments)}}var t=e.prototype;var n=this;var r=n.EventEmitter;t.getListeners=function(t){var n=this._getEvents();var r;var i;if(typeof t==="object"){r={};for(i in n){if(n.hasOwnProperty(i)&&t.test(i)){r[i]=n[i]}}}else{r=n[t]||(n[t]=[])}return r};t.flattenListeners=function(t){var n=[];var r;for(r=0;r<t.length;r+=1){n.push(t[r].listener)}return n};t.getListenersAsObject=function(t){var n=this.getListeners(t);var r;if(n instanceof Array){r={};r[t]=n}return r||n};t.addListener=function(t,n){var r=this.getListenersAsObject(t);var s=typeof n==="object";var o;for(o in r){if(r.hasOwnProperty(o)&&i(r[o],n)===-1){r[o].push(s?n:{listener:n,once:false})}}return this};t.on=s("addListener");t.addOnceListener=function(t,n){return this.addListener(t,{listener:n,once:true})};t.once=s("addOnceListener");t.defineEvent=function(t){this.getListeners(t);return this};t.defineEvents=function(t){for(var n=0;n<t.length;n+=1){this.defineEvent(t[n])}return this};t.removeListener=function(t,n){var r=this.getListenersAsObject(t);var s;var o;for(o in r){if(r.hasOwnProperty(o)){s=i(r[o],n);if(s!==-1){r[o].splice(s,1)}}}return this};t.off=s("removeListener");t.addListeners=function(t,n){return this.manipulateListeners(false,t,n)};t.removeListeners=function(t,n){return this.manipulateListeners(true,t,n)};t.manipulateListeners=function(t,n,r){var i;var s;var o=t?this.removeListener:this.addListener;var u=t?this.removeListeners:this.addListeners;if(typeof n==="object"&&!(n instanceof RegExp)){for(i in n){if(n.hasOwnProperty(i)&&(s=n[i])){if(typeof s==="function"){o.call(this,i,s)}else{u.call(this,i,s)}}}}else{i=r.length;while(i--){o.call(this,n,r[i])}}return this};t.removeEvent=function(t){var n=typeof t;var r=this._getEvents();var i;if(n==="string"){delete r[t]}else if(n==="object"){for(i in r){if(r.hasOwnProperty(i)&&t.test(i)){delete r[i]}}}else{delete this._events}return this};t.removeAllListeners=s("removeEvent");t.emitEvent=function(t,n){var r=this.getListenersAsObject(t);var i;var s;var o;var u;for(o in r){if(r.hasOwnProperty(o)){s=r[o].length;while(s--){i=r[o][s];if(i.once===true){this.removeListener(t,i.listener)}u=i.listener.apply(this,n||[]);if(u===this._getOnceReturnValue()){this.removeListener(t,i.listener)}}}}return this};t.trigger=s("emitEvent");t.emit=function(t){var n=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,n)};t.setOnceReturnValue=function(t){this._onceReturnValue=t;return this};t._getOnceReturnValue=function(){if(this.hasOwnProperty("_onceReturnValue")){return this._onceReturnValue}else{return true}};t._getEvents=function(){return this._events||(this._events={})};e.noConflict=function(){n.EventEmitter=r;return e};if(typeof define==="function"&&define.amd){define("eventEmitter/EventEmitter",[],function(){return e})}else if(typeof module==="object"&&module.exports){module.exports=e}else{this.EventEmitter=e}}).call(this);(function(e){function r(t){var n=e.event;n.target=n.target||n.srcElement||t;return n}var t=document.documentElement;var n=function(){};if(t.addEventListener){n=function(e,t,n){e.addEventListener(t,n,false)}}else if(t.attachEvent){n=function(e,t,n){e[t+n]=n.handleEvent?function(){var t=r(e);n.handleEvent.call(n,t)}:function(){var t=r(e);n.call(e,t)};e.attachEvent("on"+t,e[t+n])}}var i=function(){};if(t.removeEventListener){i=function(e,t,n){e.removeEventListener(t,n,false)}}else if(t.detachEvent){i=function(e,t,n){e.detachEvent("on"+t,e[t+n]);try{delete e[t+n]}catch(r){e[t+n]=undefined}}}var s={bind:n,unbind:i};if(typeof define==="function"&&define.amd){define("eventie/eventie",s)}else{e.eventie=s}})(this);(function(e,t){imagesLoaded=t(e,e.EventEmitter,e.eventie)})(window,function(t,n,r){function u(e,t){for(var n in t){e[n]=t[n]}return e}function f(e){return a.call(e)==="[object Array]"}function l(e){var t=[];if(f(e)){t=e}else if(typeof e.length==="number"){for(var n=0,r=e.length;n<r;n++){t.push(e[n])}}else{t.push(e)}return t}function c(e,t,n){if(!(this instanceof c)){return new c(e,t)}if(typeof e==="string"){e=document.querySelectorAll(e)}this.elements=l(e);this.options=u({},this.options);if(typeof t==="function"){n=t}else{u(this.options,t)}if(n){this.on("always",n)}this.getImages();if(i){this.jqDeferred=new i.Deferred}var r=this;setTimeout(function(){r.check()})}function h(e){this.img=e}function d(e){this.src=e;p[e]=this}var i=t.jQuery;var s=t.console;var o=typeof s!=="undefined";var a=Object.prototype.toString;c.prototype=new n;c.prototype.options={};c.prototype.getImages=function(){this.images=[];for(var e=0,t=this.elements.length;e<t;e++){var n=this.elements[e];if(n.nodeName==="IMG"){this.addImage(n)}var r=n.nodeType;if(!r||!(r===1||r===9||r===11)){continue}var i=n.querySelectorAll("img");for(var s=0,o=i.length;s<o;s++){var u=i[s];this.addImage(u)}}};c.prototype.addImage=function(e){var t=new h(e);this.images.push(t)};c.prototype.check=function(){function r(r,i){if(e.options.debug&&o){s.log("confirm",r,i)}e.progress(r);t++;if(t===n){e.complete()}return true}var e=this;var t=0;var n=this.images.length;this.hasAnyBroken=false;if(!n){this.complete();return}for(var i=0;i<n;i++){var u=this.images[i];u.on("confirm",r);u.check()}};c.prototype.progress=function(e){this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;var t=this;setTimeout(function(){t.emit("progress",t,e);if(t.jqDeferred&&t.jqDeferred.notify){t.jqDeferred.notify(t,e)}})};c.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=true;var t=this;setTimeout(function(){t.emit(e,t);t.emit("always",t);if(t.jqDeferred){var n=t.hasAnyBroken?"reject":"resolve";t.jqDeferred[n](t)}})};if(i){i.fn.imagesLoaded=function(e,t){var n=new c(this,e,t);return n.jqDeferred.promise(i(this))}}h.prototype=new n;h.prototype.check=function(){var e=p[this.img.src]||new d(this.img.src);if(e.isConfirmed){this.confirm(e.isLoaded,"cached was confirmed");return}if(this.img.complete&&this.img.naturalWidth!==undefined){this.confirm(this.img.naturalWidth!==0,"naturalWidth");return}var t=this;e.on("confirm",function(e,n){t.confirm(e.isLoaded,n);return true});e.check()};h.prototype.confirm=function(e,t){this.isLoaded=e;this.emit("confirm",this,t)};var p={};d.prototype=new n;d.prototype.check=function(){if(this.isChecked){return}var e=new Image;r.bind(e,"load",this);r.bind(e,"error",this);e.src=this.src;this.isChecked=true};d.prototype.handleEvent=function(e){var t="on"+e.type;if(this[t]){this[t](e)}};d.prototype.onload=function(e){this.confirm(true,"onload");this.unbindProxyEvents(e)};d.prototype.onerror=function(e){this.confirm(false,"onerror");this.unbindProxyEvents(e)};d.prototype.confirm=function(e,t){this.isConfirmed=true;this.isLoaded=e;this.emit("confirm",this,t)};d.prototype.unbindProxyEvents=function(e){r.unbind(e.target,"load",this);r.unbind(e.target,"error",this)};return c});$=jQuery;totalPlugins=0;callQueue=[];Li=function(){function Li(el,settings){var $el,$img;$el=$(el);this.originalWidth=this.width=$el.outerWidth(false);this.originalHeight=this.height=$el.height();this.originalMargin=this.margin=$el.outerWidth(true)-$el.outerWidth(false);$img=$el.find("img");this.imgRatio=$img.width()/$img.height();this.$el=$el;this.settings=settings}Li.prototype.setHeight=function(h){this.width=Math.round(h*(this.width/this.height));if(!this.settings.lockedHeight){return this.height=h}};Li.prototype.setWidth=function(w){this.height=Math.round(w*(this.height/this.width));return this.width=w};Li.prototype.decWidth=function(){return this.setWidth(this.width-1)};Li.prototype.decHeight=function(){return this.setHeight(this.height-1)};Li.prototype.incWidth=function(){return this.setWidth(this.width+1)};Li.prototype.incHeight=function(){return this.setHeight(this.height+1)};Li.prototype.updateDOM=function(){this.$el.css({width:this.width,height:this.height,"margin-right":this.margin});return this.$el.find("img").height("auto")};Li.prototype.reset=function(){this.width=this.originalWidth;this.height=this.originalHeight;this.margin=this.originalMargin;return this.$el.css({width:this.width,height:this.height,"margin-right":this.margin})};return Li}();Row=function(){function Row(frameWidth,settings){this.frameWidth=frameWidth;this.settings=settings;this.lis=[]}Row.prototype.width=function(){var li,width,_i,_len,_ref;width=0;_ref=this.lis;for(_i=0,_len=_ref.length;_i<_len;_i++){li=_ref[_i];width+=li.width+li.margin}return width};Row.prototype.updateDOM=function(){var li,_i,_len,_ref,_results;_ref=this.lis;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){li=_ref[_i];_results.push(li.updateDOM())}return _results};Row.prototype.reset=function(){var li,_i,_len,_ref,_results;_ref=this.lis;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){li=_ref[_i];_results.push(li.reset())}return _results};Row.prototype.landscapeGroups=function(){var i,landscapeGroups,landscapes,li,ratio,_ref;landscapeGroups=[];_ref=this.settings.landscapeRatios;for(i in _ref){ratio=_ref[i];landscapes=function(){var _i,_len,_ref1,_results;_ref1=this.lis;_results=[];for(_i=0,_len=_ref1.length;_i<_len;_i++){li=_ref1[_i];if(li.imgRatio>=ratio){_results.push(li)}}return _results}.call(this);landscapeGroups.push(landscapes)}return landscapeGroups};Row.prototype.resizeLandscapes=function(){var i,landscapes,li,_i,_j,_k,_len,_len1,_ref,_ref1;_ref=this.landscapeGroups(this.settings.landscapeRatios);for(_i=0,_len=_ref.length;_i<_len;_i++){landscapes=_ref[_i];if(!(landscapes.length!==0)){continue}for(i=_j=0,_ref1=this.settings.resizeLandscapesBy;0<=_ref1?_j<=_ref1:_j>=_ref1;i=0<=_ref1?++_j:--_j){for(_k=0,_len1=landscapes.length;_k<_len1;_k++){li=landscapes[_k];li.decHeight()}if(this.width()<=this.frameWidth){break}}if(this.width()<=this.frameWidth){break}}return this};Row.prototype.adjustMargins=function(){var i,li,_i,_j,_len,_ref,_ref1,_results;_results=[];for(i=_i=0,_ref=this.settings.adjustMarginsBy;0<=_ref?_i<=_ref:_i>=_ref;i=0<=_ref?++_i:--_i){_ref1=this.lis.slice(0,+(this.lis.length-2)+1||9e9);for(_j=0,_len=_ref1.length;_j<_len;_j++){li=_ref1[_j];li.margin--;if(this.width()<=this.frameWidth){break}}if(this.width()<=this.frameWidth){break}else{_results.push(void 0)}}return _results};Row.prototype.resizeHeight=function(){var i,li,_results;i=0;_results=[];while(this.width()>this.frameWidth&&i<this.settings.resizeRowBy){i++;_results.push(function(){var _i,_len,_ref,_results1;_ref=this.lis;_results1=[];for(_i=0,_len=_ref.length;_i<_len;_i++){li=_ref[_i];_results1.push(li.decHeight())}return _results1}.call(this))}return _results};Row.prototype.roundOff=function(){var li,_i,_len,_ref,_results;_ref=this.lis;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){li=_ref[_i];_results.push(li.setWidth(Math.floor(li.width)))}return _results};Row.prototype.fillLeftoverPixels=function(){var diff,randIndex,_results;this.roundOff();diff=function(_this){return function(){return _this.frameWidth-_this.width()}}(this);_results=[];while(diff()!==0){randIndex=Math.round(Math.random()*(this.lis.length-1));if(diff()<0){_results.push(this.lis[randIndex].decWidth())}else{_results.push(this.lis[randIndex].incWidth())}}return _results};Row.prototype.removeMargin=function(){var lastLi;lastLi=this.lis[this.lis.length-1];return lastLi.margin=0};Row.prototype.lockHeight=function(){var li,tallestHeight,tallestLi,_i,_len,_ref,_results;tallestLi=this.lis.sort(function(a,b){return b.height-a.height})[0];tallestHeight=Math.ceil(tallestLi.height);_ref=this.lis;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){li=_ref[_i];_results.push(li.height=tallestHeight)}return _results};Row.prototype.hide=function(){var li,_i,_len,_ref,_results;_ref=this.lis;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){li=_ref[_i];_results.push(li.$el.hide())}return _results};Row.prototype.show=function(){var li,_i,_len,_ref,_results;_ref=this.lis;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){li=_ref[_i];_results.push(li.$el.show())}return _results};return Row}();debounce=function(func,wait){var timeout;timeout=0;return function(){var args,throttler;args=arguments;throttler=function(_this){return function(){timeout=null;return func(args)}}(this);clearTimeout(timeout);return timeout=setTimeout(throttler,wait)}};methods={init:function(settings){var i,_defaults;_defaults={resizeLandscapesBy:200,resizeRowBy:30,landscapeRatios:function(){var _i,_results;_results=[];for(i=_i=10;_i<=50;i=_i+=3){_results.push(i/10)}return _results}().reverse(),fillLastRow:false,beforeFillWidth:null,afterFillWidth:null};this.settings=$.extend(_defaults,settings);return this.each(function(_this){return function(i,el){var $el,$imgs,initFillWidth;$el=$(el);methods.initStyling.call(_this,$el);initFillWidth=function(){methods.fillWidth.call(_this,$el);if(!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/MSIE 8\.0/i))){$(window).bind("resize.fillwidth",debounce(function(){var fn,_i,_len;callQueue.push(function(){return methods.fillWidth.call(_this,$el)});if(callQueue.length===totalPlugins){for(_i=0,_len=callQueue.length;_i<_len;_i++){fn=callQueue[_i];fn()}return callQueue=[]}},300))}return totalPlugins++};$imgs=$el.find("img");if(_this.settings.imageDimensions!=null){return initFillWidth()}else{return imagesLoaded($el,function(){return initFillWidth()})}}}(this))},initStyling:function(el){var $el;$el=$(el);$el.css({"list-style":"none",padding:0,margin:0,overflow:"hidden"});if(this.settings.initStyling!=null){$el.css(this.settings.initStyling)}$el.find("> li").css({"float":"left","margin-left":0});$el.find("img").css({"max-width":"100%","max-height":"100%"});if(this.settings&&this.settings.imageDimensions!=null){return $el.find("> li").each(function(_this){return function(i,el){var $img;$img=$(el).find("img").first();$img.width(_this.settings.imageDimensions[i].width);return $img.height(_this.settings.imageDimensions[i].height)}}(this))}},destroy:function(){$(window).unbind("resize.fillwidth");return this.each(function(){var row,_i,_len,_ref;_ref=$(this).fillwidth("rowObjs");for(_i=0,_len=_ref.length;_i<_len;_i++){row=_ref[_i];row.reset()}return $(this).removeData("fillwidth.rows")})},fillWidth:function(el){var $el,row,rows,_i,_j,_len,_len1,_ref;$el=$(el);$el.trigger("fillwidth.beforeFillWidth");if(this.settings.beforeFillWidth!=null){this.settings.beforeFillWidth()}if(this.fillwidthRows){_ref=this.fillwidthRows;for(_i=0,_len=_ref.length;_i<_len;_i++){row=_ref[_i];row.reset()}}$el.width("auto");$el.trigger("fillwidth.beforeNewRows");if(this.settings.beforeNewRows!=null){this.settings.beforeNewRows()}this.frameWidth=$el.width();rows=methods.breakUpIntoRows.call(this,$el);this.fillwidthRows=rows;$el.width(this.frameWidth);$el.trigger("fillwidth.afterNewRows");if(this.settings.afterNewRows!=null){this.settings.afterNewRows()}for(_j=0,_len1=rows.length;_j<_len1;_j++){row=rows[_j];if(!(row.lis.length>1)){continue}row.removeMargin();row.resizeHeight();if(this.settings.adjustMarginsBy!=null){row.adjustMargins()}row.resizeLandscapes();if(!(row===rows[rows.length-1]&&!this.settings.fillLastRow)){row.fillLeftoverPixels()}row.lockHeight();row.updateDOM()}$el.trigger("fillwidth.afterFillWidth");if(this.settings.afterFillWidth!=null){return this.settings.afterFillWidth()}},rowObjs:function(){var arr,rows;arr=[];rows=this.fillwidthRows;this.each(function(){return arr.push(rows)});if(arr.length===1){arr=arr[0]}return arr},rows:function(){var arr,li,row,rows,_i,_len;rows=methods.rowObjs.call(this);arr=[];for(_i=0,_len=rows.length;_i<_len;_i++){row=rows[_i];arr.push(function(){var _j,_len1,_ref,_results;_ref=row.lis;_results=[];for(_j=0,_len1=_ref.length;_j<_len1;_j++){li=_ref[_j];_results.push(li.$el)}return _results}())}if(arr.length===1){arr=arr[0]}return arr},breakUpIntoRows:function(el){var $el,i,rows;$el=$(el);i=0;rows=[new Row(this.frameWidth,this.settings)];$el.find("> li").each(function(_this){return function(j,li){if($(li).is(":hidden")){return}rows[i].lis.push(new Li(li,_this.settings));if(rows[i].width()>=$el.width()&&j!==$el.find("> li").length-1){rows.push(new Row(_this.frameWidth,_this.settings));return i++}}}(this));return rows}};$.fn.fillwidth=function(method){if(methods[method]!=null){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==="object"||method==null){return methods.init.apply(this,arguments)}else{return $.error("Method "+method+" does not exist on jQuery.fillwidth")}}}).call(this);